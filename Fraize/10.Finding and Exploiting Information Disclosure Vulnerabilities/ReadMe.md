# Finding and exploiting Information Disclosure Vulnerabilities

## How to test for information disclosure vulnerabilities
- Do not develop **tunnel vision** during testing because sensitive data can be leaked in all kinds of places. Don't miss anything that could be useful later.
- Be able to recognize interesting information whenever and wherever you do come across it.
- Some high level techniques and tools that can be helpful to identifying information disclosure vulnerabilities during testing include:

### 1. `Fuzzing`
- Is an automated software testing technique that involves providing  invalid, unexpected or random data as inputs to a computer program.
  > Is a quality assurance technique used to discover coding errors and security loopholes in software, operating systems or networks.
- It involves inputting massive amounts of random data called `fuzz` to the test subject in an attempt to make it crash.
- Pay close attention, although responses sometimes explicitly disclose interesting information, they can also hint at the application's behavior more subtly.
- Even if the content of an error message doesn't disclose anything, sometimes the fact that one error case was encountered instead of another one is useful information in itself.
- You can automate much of this process using tools such as Burp Intruder. This provides several benefits. You can:
    a. Add `payload positions` to parameters and use pre-built wordlists of fuzz strings to test a high volume of different inputs in quick succession.
    b. Easily identify differences in responses by comparing HTTP status codes, response times, lengths and so on.
    c. Use `grep` matching rules to quickly identify occurrences of keywords such as *error*, *invalid*, *SELECT*, *SQL* etc.
    d. Apply `grep extraction rules` to extract and compare the contect of interesting items within responses.
- One can also use the `Logger++` extension, available from *BApp store*. In addition to logging requests and responses from all of Burp's tools, it allows one to define advanced filters for highlighting interesting entries.

### 2. `Using Burp Scanner`
- This provides live scanning features for auditing items while you browse or can schedule automated scans to crawl and audit the target site on your behalf.
- Both approaches will automatically flag many information disclosure vulnerabilities for you.
- Burp scanner in burp suite professional, will alert you if it finds sensitive information such as private keys, email addresses and credit card numbers in a response. It will also identify any backup files, directory listings etc.

### 3. `Using Burp's engagement tools`
- Burp provides several engagement tools that you can use to find interesting information in the target website more easily.
- The following tools are useful in this context:
    a. `Search`
    - You can use this tool to look for any expressin within the selected item.
    - You can fine-tune for quickly finding occurrences or absences of specific keywords of interest.
    b. `Find comments`
    - You can use this tool to quickly extract any developer comments found in the selected item. 
    - It also provides tabs to instantly access the HTTP request/response cycle in which each comment was found.
    c. `Discover content`
    - You can use this tool to identify additional content and functionality that is not linked from the website's visible content.
    - This can be useful for finding additional directories and files that won't necessarily appear in the site map automatically.

### 4. `Engineering informative responses`
- Verbose error messages can sometimes disclose interesting information while you go about normal testing workflow.
- However, by studying the way error messages change according to your input, you can take this one step further and in some cases will be able to manipulate the website in order to extract arbitrary data via an error message.
- You can sometimes cause error messages to disclose the value of your desired data in the field.

## Sources of Information Disclosure
- Information disclosure can occur in a wide variety of contexts within a website. 
- The following are some common examples of places where you can look to see if sensitive information is exposed.
### 1. `Files for web crawlers`
- Many websites provide files at `/robots.txt` and `sitemap.xml` to help crawlers navigate their site.
- A `crawler` is a computer program that automatically searches documents on the web.
- Among other things, these files often list specific directories that the crawlers should skip because they may contain sensitive information.
- These files are not usually linked from within the website, they may not appear in Burp's site map.
- However, it is worth trying to navigate to `/robots.txt` or `/sitemap.xml` manually to see if you find anthing of use.

### 2. `Directory Listings`
- Web servers can be configured to automatically list the contents of directories that do not have an index page present.
- This can aid an attacker by enabling them to quickly identify the resources at a given path and proceed directly to analyzing and attacking those resources.
- It increases the exposure of sensitive files within the directory that are not intended to accessible to users, such as temporary files and crush dumps.
- Directory listings themselves are not a security vulnerability however, if the website also fails to implement proper access control, leaking the existence and location of sensitive resources in this way is clearly an issue.

### 3. `Developer comments`
- During development, in-line HTML comments are sometimes added to the markup which are stripped before changes are deployed to the production environment.
- Comments can sometimes be forgotten, missed or even left in deliberately because someone wasn't fully aware of the security implications. Although  not visible on the rendered page, they can easily be accessed using Burp or even browser's built-in developer tools.
- Eg they might hing at the existence of hidden directories or provide clues about the application logic.

### 4. `Error messages`
- One of the most common causes of information disclosure is verbose error messages.
- The content of error messages can reveal information about what input or data type is expected from a given parameter which can help you narrow down your attack by identifying expoitable parameters and may even prevent you from wasting time trying to inject payloads that may not work.
- Verbose error messages can also provide information about different technologies being used by the website.
- You can check whether there are any common configuration errors or dangerous default settings that you may be able to exploit.
- You may also discover that the website is using some kind of open-source framework whereby in this case you can study the publicly available source code which is an invaluable resource for constructing own exploits.
- Differences between error messages can also reveal different application behavior that is occurring behind the scenes.
- Observing differences in error messages is a crucial aspect of many techniques such as `SQL injection`, `username enumeration` etc.

### 5. `Debugging Data`
- For debugging purposes, many websites generate custom error messages and logs that contain large amounts of information about the application's behavior.
- While this information is useful during development, ot os also extremely useful to an attacker if it is leaked in the production environment.
- Debug messages can sometimes contain vital information for developing an attack, including:
    a. Values for key session variables that can be manipulated via user input.
    b. Hostnames and credentials for back-end components.
    c. File and directory names on the server.
    d. Keys used to encrypt data transmitted via the client.
- Debugging information may sometimes be logged in a separate file.
- If an attacker is able to gain access to this file, it can serve as a useful reference for understanding the application's runtime state.

### 6. `User account pages`
- A user's profile or account page usually contains sensitive information such as the user's email address, phone number, API key etc.
- As users normally have access to their own account page, this doesn't representa vulnerability in itself.
- Some websites contain logic flaws that potentially allow an attacker to leverage these pages in order to view other users' data.
- Consider a website that determines which user's account page to load based on a `user` parameter.
```
GET /user/personal-info?user=carlos
```
- Most websites will take steps to prevent an attacker from simply changing this parameter to access arbitrary users' account pages, however, sometimes the logic for loading individual items of data is not as robust.
- An attacker may not be able to load another users' account page entirely, but the logic for fetching and rendering the user's registered email address, eg might not check that the `user` parameter matches the user that is currently logged in.

### 7. `Source code disclosure via backup files`
- Obtaining source code access makes it much easier for an attacker to understand the application's behavior and construct high-severity attacks.
- Sensitive data can sometimes be hard-coded within the source code such as API keys and credentials for accessing back-end components.
- It is possible to cause the website to expose its own source code.
- When mapping out a website, you might find that some source code files are referenced explicitly.
- When a server handles files with a particular extension such as `.php`, it will typically execute the code, rather than simply sending it to the client as text.
- In some situations, one can trick a website into returning the contents of the file instead.
- Requesting a code file using a backup file extension can sometimes allow you to read the contents of the file in the response.

### 8. `Information disclosure due to insecure configuration`
- Websites are sometimes vulnerable as a result of improper configuration.
- This is common due to the widespread use of third-party technologies, whose vast array of configuration options are not necessarily well-understood by those implementing them.
- Developers might forget to disable various debugging options in the production environment.
- Eg: The `HTTP TRACE` method is designed for diagnostic purposes. If enabled the web server will respond to requests that use the `TRACE` method by echoing in the response the exact request that was received. This occasionally leads to information disclosure such as the name of internal authentication headers that may be appended to requests by reverse proxies.

### 9. `Version control history`
- Virtually all websites are developed using some form of version control system such as `Git`.
- By default, a Git project stores all of its version control data in a folder called `.git`.
- Occasionally, websites expose this directory in the production environment and might be accessible by simply browsing `/.git`
- It may be impractical to manually browse the raw file structure and contents, there are various methods for downloading the entire *.git* directory which can then be opened using local installation of Git to gain access to the website's version control history.
- This may include logs containing committed changes and other interesting information.
- This might not give access to the full source code, but comparing the diff will allow one too read small snippets of code.

--------------------------------------------------------------------------------
### Referencing
- [PortSwigger](https://portswigger.net/web-security/information-disclosure/exploiting)

### Labs
- [Information disclosure in error messages](https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-in-error-messages)
- [Information disclosure on debug page](https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-on-debug-page)
- [Source code disclosure via backup files](https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-via-backup-files)
- [Authentication bypass via information disclosure](https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-authentication-bypass)
- [Information disclosure in version control history](https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-in-version-control-history)
